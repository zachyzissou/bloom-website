---
/**
 * FactionCard Component
 *
 * Static faction card with CSS containment for performance
 * No JavaScript needed - fully static with CSS hover effects
 *
 * Usage:
 *   <FactionCard
 *     name="Sky Bastion Directorate"
 *     tagline="Military precision, unwavering authority"
 *     emblem="/images/factions/sky-bastion-emblem.webp"
 *     colors={{ primary: '#1e3a8a', secondary: '#475569' }}
 *   />
 */

interface Props {
  /** Faction name */
  name: string;
  /** Short tagline/description */
  tagline: string;
  /** Path to faction emblem */
  emblem: string;
  /** Faction color scheme */
  colors: {
    primary: string;
    secondary: string;
  };
  /** Optional link to faction page */
  href?: string;
}

const { name, tagline, emblem, colors, href } = Astro.props;

// Determine if this is a link or static card
const isLink = Boolean(href);
const Component = isLink ? 'a' : 'article';
---

<Component
  href={href}
  class="faction-card group block"
  style={`--faction-primary: ${colors.primary}; --faction-secondary: ${colors.secondary};`}
>
  <div class="card-inner">
    <!-- Emblem -->
    <div class="emblem-container">
      <img
        src={emblem}
        alt={`${name} emblem`}
        width="120"
        height="120"
        loading="lazy"
        decoding="async"
        class="emblem"
      />
    </div>

    <!-- Content -->
    <div class="content">
      <h3 class="faction-name">{name}</h3>
      <p class="tagline">{tagline}</p>
    </div>

    <!-- Hover indicator (if link) -->
    {isLink && (
      <div class="hover-indicator">
        <span class="sr-only">View faction details</span>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-6 h-6"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 5l7 7-7 7"
          />
        </svg>
      </div>
    )}
  </div>
</Component>

<style>
  /* CSS containment for performance */
  .faction-card {
    contain: layout style paint;
    display: flex;
    width: 280px;
    max-width: 100%;
  }

  @media (min-width: 640px) {
    .faction-card {
      width: 300px;
    }
  }

  .card-inner {
    position: relative;
    flex: 1;
    display: flex;
    flex-direction: column;
    background: linear-gradient(135deg, var(--faction-primary), var(--faction-secondary));
    border-radius: 0.5rem;
    padding: 1.5rem;
    overflow: hidden;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  /* Hover effects (GPU-accelerated) */
  a.faction-card:hover .card-inner,
  a.faction-card:focus .card-inner {
    transform: translateY(-4px);
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.2);
  }

  /* Emblem */
  .emblem-container {
    display: flex;
    justify-content: center;
    margin-bottom: 1rem;
    flex-shrink: 0;
  }

  .emblem {
    width: 120px;
    height: 120px;
    object-fit: contain;
    filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.3));
    transition: transform 0.2s ease;
  }

  a.faction-card:hover .emblem,
  a.faction-card:focus .emblem {
    transform: scale(1.05);
  }

  /* Content */
  .content {
    text-align: center;
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  .faction-name {
    font-family: var(--font-heading, 'Orbitron', sans-serif);
    font-size: 1.25rem;
    font-weight: 700;
    color: white;
    margin-bottom: 0.5rem;
    line-height: 1.2;
  }

  .tagline {
    font-size: 0.875rem;
    color: rgba(255, 255, 255, 0.9);
    line-height: 1.4;
  }

  /* Hover indicator */
  .hover-indicator {
    position: absolute;
    top: 1rem;
    right: 1rem;
    color: white;
    opacity: 0;
    transform: translateX(-10px);
    transition: opacity 0.2s ease, transform 0.2s ease;
  }

  a.faction-card:hover .hover-indicator,
  a.faction-card:focus .hover-indicator {
    opacity: 1;
    transform: translateX(0);
  }

  /* Accessibility */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }

  /* Focus styles for keyboard navigation */
  a.faction-card:focus {
    outline: 2px solid white;
    outline-offset: 4px;
  }
</style>
