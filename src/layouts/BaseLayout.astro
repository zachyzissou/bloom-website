---
/**
 * Base Layout - Main layout wrapper for all pages
 * Includes SEO, Analytics, Navigation, and global styles
 */
import { ViewTransitions } from 'astro:transitions';
import SEO from '@/components/SEO.astro';
import Analytics from '@/components/Analytics.astro';
import Navigation from '@/components/Navigation.astro';
import Footer from '@/components/Footer.astro';
import BackgroundMusic from '@/components/BackgroundMusic.astro';
import AudioConsentModal from '@/components/AudioConsentModal.astro';

export interface Props {
  title: string;
  description: string;
  image?: string;
  type?: 'website' | 'article' | 'game' | 'product';
  noindex?: boolean;
}

const { title, description, image, type = 'website', noindex = false } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- View Transitions for smooth page navigation -->
    <ViewTransitions />

    <!-- SEO Component -->
    <SEO title={title} description={description} image={image} type={type} noindex={noindex} />

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />

    <!-- Fonts - Self-hosted (optional) -->
    <!--
      IMPORTANT: Self-hosted fonts are optional for development.
      - See public/fonts/README.md for font installation instructions
      - To use Google Fonts CDN instead, uncomment the links below and remove the preload links
    -->

    <!-- Option 1: Self-hosted fonts (requires fonts in public/fonts/) -->
    <!--
    <link
      rel="preload"
      href="/fonts/orbitron-v29-latin-regular.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />
    <link
      rel="preload"
      href="/fonts/inter-v13-latin-regular.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />
    -->

    <!-- Option 2: Google Fonts CDN (uncomment to use) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Orbitron:wght@400;700&display=swap"
      rel="stylesheet"
    />

    <!-- Analytics Component -->
    <Analytics />

    <!-- VideoGame Structured Data (JSON-LD) -->
    <script
      is:inline
      type="application/ld+json"
      set:html={JSON.stringify({
        '@context': 'https://schema.org',
        '@type': 'VideoGame',
        name: 'Bloom',
        description,
        url: 'https://bloom-game.com',
        applicationCategory: 'Game',
        operatingSystem: 'Windows',
        genre: ['Shooter', 'Action', 'Co-op', 'Multiplayer'],
        gamePlatform: ['PC (Steam)'],
        playMode: 'CoOp',
        numberOfPlayers: {
          '@type': 'QuantitativeValue',
          minValue: 1,
          maxValue: 10,
        },
        creator: {
          '@type': 'Organization',
          name: 'Bloom Team',
        },
        offers: {
          '@type': 'AggregateOffer',
          lowPrice: '24.99',
          highPrice: '39.99',
          priceCurrency: 'USD',
          availability: 'https://schema.org/PreOrder',
          url: 'https://store.steampowered.com',
        },
      })}
    />

    <!-- Global Styles (Tailwind + Custom) -->
    <style is:global>
      @import '../styles/global.css';

      /* Main content padding for fixed navbar */
      main {
        padding-top: 5rem;
      }
    </style>
  </head>
  <body>
    <!-- Skip to content link for keyboard navigation -->
    <a href="#main-content" class="skip-to-content">Skip to main content</a>

    <!-- Navigation Component -->
    <Navigation />

    <!-- Main content slot with padding for fixed navbar -->
    <main id="main-content">
      <slot />
    </main>

    <!-- Footer Component -->
    <Footer />

    <!-- Audio Consent Modal -->
    <AudioConsentModal />

    <!-- Background Music Component (persistent across page transitions) -->
    <BackgroundMusic transition:persist="bg-music" />
  </body>
</html>
